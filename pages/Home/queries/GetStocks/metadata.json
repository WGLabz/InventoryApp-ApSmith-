{
  "gitSyncId": "6703b251c982f54ff180d40c_93c601f6-a43b-4fd2-a9d4-ed81187fad88",
  "id": "Home_GetStocks",
  "pluginId": "postgres-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "SELECT \n    c.name,\n    c.component_id,\n    c.description,\n    c.date_added,\n    c.image_content,\n    c.image_type,\n    b.box_code,\n    c.category_id,\n    b.box_label,\n    ct.category_name,\n    b.box_id,\n    COALESCE((SELECT SUM(quantity_ordered) FROM order_parts WHERE component_id = c.component_id), 0) AS purchased,\n    COALESCE(\n        (SELECT SUM(quantity_used) FROM project_components WHERE component_id = c.component_id), \n        0\n    ) + COALESCE(\n        (SELECT SUM(quantity_used) FROM general_usage WHERE component_id = c.component_id),\n        0\n    ) AS used,\n    COALESCE(\n        (SELECT SUM(quantity_ordered) FROM order_parts WHERE component_id = c.component_id), \n        0\n    ) - (\n        COALESCE(\n            (SELECT SUM(quantity_used) FROM project_components WHERE component_id = c.component_id), \n            0\n        ) + COALESCE(\n            (SELECT SUM(quantity_used) FROM general_usage WHERE component_id = c.component_id),\n            0\n        )\n    ) AS stock\nFROM \n    components c\nLEFT JOIN \n    boxes b ON b.box_id = c.box_id\nLEFT JOIN \n    categories ct ON ct.category_id = c.category_id\nWHERE \n    c.name LIKE '%{{ ComponentsTable.searchText }}%'\nORDER BY \n    {{ !!ComponentsTable.sortOrder.column ? ComponentsTable.sortOrder.column : 'name' }} \n    {{ !!ComponentsTable.sortOrder.order ? !!ComponentsTable.sortOrder.order : 'desc' }}\nLIMIT \n    {{ ComponentsTable.pageSize }} \nOFFSET \n    {{ (ComponentsTable.pageNo - 1) * ComponentsTable.pageSize }};\n",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": false
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "Koyeb Postgres DB",
      "isAutoGenerated": false,
      "name": "Koyeb Postgres DB",
      "pluginId": "postgres-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "name": "GetStocks",
    "pageId": "Home",
    "runBehaviour": "ON_PAGE_LOAD",
    "userSetOnLoad": false
  }
}